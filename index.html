<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Betatree : Generate and analyze beta coalescent trees">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Betatree</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/rneher/betatree">View on GitHub</a>

          <h1 id="project_title">Betatree</h1>
          <h2 id="project_tagline">Generate and analyze beta coalescent trees</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/rneher/betatree/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/rneher/betatree/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p><img src="https://github.com/rneher/betatree/blob/master/example_SFS/sfs_logit_binning.png" alt="Site Frequency Spectra">
betatree is a collection of python scripts to generate trees from the beta coalescent ensemble, calculate properties of those trees and gather statistics across many instances. </p>

<p>Authors: Taylor Kessinger and Richard Neher</p>

<p>Contact: <a href="mailto:richard.neher@tuebingen.mpg.de">richard.neher@tuebingen.mpg.de</a></p>

<p>Example output of the betatree generator are given as pdf files in example_trees. Example site frequency spectra for different parameters of the beta-coalescent ensemble are provided in example_SFS.</p>

<h3>
<a name="tree-generation" class="anchor" href="#tree-generation"><span class="octicon octicon-link"></span></a>Tree generation</h3>

<p>the script src/betatree.py provides a class that generates coalescent trees using pseudorandom numbers given an initial sample size n and a parameter alpha of the beta measure of the Lambda coalescent process. The following 3 lines will generate a tree of a sample size of 100 and draw it with the Biopython.Phylo package.</p>

<pre><code>myT = betatree(100,alpha = 2)
myT.coalesce()
Phylo.draw(myT.BioTree)
</code></pre>

<p>the tree is internally stored as a biopython.phylo tree with all the associated  functionality.</p>

<p>Sample code is appended to the definition of the class as will be exectuted if betatree.py is run as main.</p>

<h3>
<a name="site-frequency-spectra" class="anchor" href="#site-frequency-spectra"><span class="octicon octicon-link"></span></a>Site frequency spectra</h3>

<p>the script src/sfs.py uses the class betatree to generate many trees and calculate the SFS assuming that mutation are uniformly distributed on the tree. The following three lines will generate an SFS for a sample size 100 and alpha=1.5 by averaging 1000 trees.</p>

<pre><code>mySFS = SFS(n=100,alpha=1.5)
mySFS.getSFS(ntrees=1000)
</code></pre>

<p>The sfs is accessible as mySFS.sfs and can be binned using different binning schemes or a user defined binning. </p>

<pre><code>mySFS.binSFS(mode='logit', bins=20)
plt.plot(mySFS.bin_center, mySFS.binned_sfs)
</code></pre>

<p>The sfs can be saved and loaded by member functions.</p>

<p>Sample code is appended to the definition of the class as will be exectuted if sfs.py is run as main.</p>

<h3>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies:</h3>

<p>python 2.7
numpy
scipy
biopython
matplotlib for plotting examples</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Betatree maintained by <a href="https://github.com/rneher">rneher</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
